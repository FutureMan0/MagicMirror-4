<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>MagicMirror‚Å¥ Config</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="themes.css">
</head>

<body data-theme="dark">
  <div class="config-container">
    <header class="config-header">
      <h1 data-i18n="appTitle">MagicMirror‚Å¥</h1>
      <div class="header-actions">
        <div class="instance-selector">
          <label data-i18n="instance">Instanz:</label>
          <select id="instance-select">
            <option value="display1">Display 1</option>
            <option value="display2">Display 2</option>
          </select>
        </div>
        <button id="settings-btn" aria-label="Einstellungen">‚öôÔ∏è</button>
      </div>
    </header>

    <!-- Tab-basierte Inhalte -->
    <main class="app-content">
      <!-- Tab 1: Module & Layout (Main View) -->
      <section id="tab-modules" class="tab-content active">
        <div class="desktop-layout-container">
          <!-- Sidebar: Modules & App Store (Desktop only or prominent on tablets) -->
          <aside class="desktop-sidebar">
            <div class="sidebar-header">
              <h2 data-i18n="modules">Module</h2>
            </div>

            <div class="sidebar-content">
              <!-- Installed Modules List -->
              <div id="sidebar-installed" class="sidebar-pane active">
                <div id="module-list"></div>
              </div>
            </div>
          </aside>

          <!-- Main Content Area -->
          <div class="config-main">
            <!-- Layout Editor / Preview Header -->
            <div class="view-header">
              <h2 id="view-title" data-i18n="layoutEditor">Layout Editor</h2>
              <div class="view-actions">
                <!-- Toggle between Classic and Visual (moved from settings for better UX) -->
                <div class="mode-switch-inline">
                  <button class="mode-btn active" id="mode-btn-visual">Visual</button>
                  <button class="mode-btn" id="mode-btn-classic">Classic</button>
                </div>
              </div>
            </div>

            <!-- Visueller Layout Editor -->
            <div class="preview-section" id="visual-editor-desktop">
              <div id="visual-editor-container-desktop">
                <!-- Visual Editor wird hier initialisiert -->
              </div>
            </div>

            <!-- Klassisches Preview (Fallback/Alternativ) -->
            <div class="preview-section" id="classic-preview-desktop" style="display: none;">
              <div id="preview-container-desktop" class="preview-container">
                <div class="preview-grid" id="preview-grid-desktop">
                  <!-- Preview wird hier gerendert -->
                </div>
              </div>
            </div>

            <!-- Module Settings (Contextual) -->
            <div class="settings-section" id="settings-section">
              <div class="settings-header">
                <h2 data-i18n="moduleSettings">Modul-Einstellungen</h2>
                <button class="close-settings-btn" id="close-settings-btn">&times;</button>
              </div>
              <div id="module-settings">
                <p class="empty-state" data-i18n="selectModuleHint">W√§hle ein Modul links, um es zu konfigurieren.</p>
              </div>
              <div class="settings-actions" id="settings-actions" style="display: none;">
                <button class="btn-secondary" id="cancel-settings-btn" data-i18n="cancel">Abbrechen</button>
                <button class="btn-primary" id="save-settings-btn" data-i18n="save">Speichern</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Tab 2: Mobile Layout (Only visible on Mobile) -->
      <section id="tab-layout" class="tab-content">
        <div id="layout-view-container-mobile">
          <!-- Identical to desktop but optimized for mobile flow -->
          <div class="preview-section" id="visual-editor-mobile">
            <div id="visual-editor-container-mobile"></div>
          </div>
        </div>
      </section>

      <!-- Tab 3: Mobile App Store (Fallback for mobile) -->
      <section id="tab-appstore" class="tab-content">
        <div class="appstore-section">
          <h2 data-i18n="appStore">Store</h2>
          <div class="appstore-grid" id="appstore-grid"></div>
        </div>
      </section>

      <!-- Tab 4: Einstellungen -->
      <section id="tab-settings" class="tab-content">
        <div class="settings-section">
          <h2 data-i18n="settings">Einstellungen</h2>

          <div class="settings-group">
            <h3 data-i18n="theme">Design</h3>
            <div class="theme-picker">
              <button data-theme="dark" class="active" data-i18n="themeDark">Dunkel</button>
              <button data-theme="light" data-i18n="themeLight">Hell</button>
              <button data-theme="oled" data-i18n="themeOled">OLED</button>
            </div>
          </div>

          <div class="settings-group">
            <h3 data-i18n="mirrorTheme">Mirror Theme</h3>
            <div class="theme-picker" id="mirror-theme-picker">
              <button data-mirror-theme="default" class="active" data-i18n="themeDefault">Default</button>
              <button data-mirror-theme="cyberpunk" data-i18n="themeCyberpunk">Cyberpunk</button>
            </div>
          </div>

          <div class="settings-group">
            <h3 data-i18n="language">Sprache</h3>
            <select id="language-select">
              <option value="de">Deutsch</option>
              <option value="en">English</option>
            </select>
          </div>

          <div class="settings-group">
            <h3 data-i18n="gridSettings">Grid-Einstellungen</h3>
            <div class="grid-settings-form">
              <!-- Layout-Modus Auswahl -->
              <div class="form-row" style="margin-bottom: 20px;">
                <label style="display: flex; flex-direction: column;">
                  <span style="margin-bottom: 8px; font-weight: 500;" data-i18n="layoutMode">Layout-Modus:</span>
                  <select id="layout-mode"
                    style="padding: 10px; border: 1px solid var(--border-color, #333); background: var(--bg-secondary, #1a1a1a); color: var(--text-primary); border-radius: 4px; font-size: 0.95rem;">
                    <option value="classic" data-i18n="classicGridMode">Klassisches Grid (Vorschau)</option>
                    <option value="visual" selected data-i18n="visualEditorMode">Visueller Editor (Experimentell)
                    </option>
                  </select>
                  <small style="color: var(--text-secondary); margin-top: 5px; font-size: 0.85rem;"
                    data-i18n="layoutModeHint">
                    W√§hle einen Modus. Der Visuelle Editor ist experimentell ‚Äì bei Problemen bitte das Klassische Grid
                    verwenden.
                  </small>
                </label>
              </div>

              <div class="form-row"
                style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                <label style="display: flex; flex-direction: column;">
                  <span data-i18n="columns" style="margin-bottom: 5px;">Spalten:</span>
                  <input type="number" id="grid-columns" min="1" max="10" value="3"
                    style="padding: 8px; border: 1px solid var(--border-color, #333); background: var(--bg-secondary, #1a1a1a); color: var(--text-primary); border-radius: 4px;">
                </label>
                <label style="display: flex; flex-direction: column;">
                  <span data-i18n="rows" style="margin-bottom: 5px;">Zeilen:</span>
                  <input type="number" id="grid-rows" min="1" max="10" value="3"
                    style="padding: 8px; border: 1px solid var(--border-color, #333); background: var(--bg-secondary, #1a1a1a); color: var(--text-primary); border-radius: 4px;">
                </label>
              </div>
              <div class="form-row"
                style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                <label style="display: flex; flex-direction: column;">
                  <span data-i18n="gap" style="margin-bottom: 5px;">Abstand (px):</span>
                  <input type="number" id="grid-gap" min="0" max="50" value="12"
                    style="padding: 8px; border: 1px solid var(--border-color, #333); background: var(--bg-secondary, #1a1a1a); color: var(--text-primary); border-radius: 4px;">
                </label>
                <label style="display: flex; flex-direction: column;">
                  <span data-i18n="padding" style="margin-bottom: 5px;">Padding (px):</span>
                  <input type="number" id="grid-padding" min="0" max="50" value="12"
                    style="padding: 8px; border: 1px solid var(--border-color, #333); background: var(--bg-secondary, #1a1a1a); color: var(--text-primary); border-radius: 4px;">
                </label>
              </div>
              <button id="save-grid-settings-btn" class="btn-primary" data-i18n="applyGridSettings">Grid-Einstellungen
                anwenden</button>
            </div>
          </div>

          <div class="settings-group" id="update-group">
            <h3 data-i18n="update">Update</h3>
            <div id="update-status">
              <span id="update-message" data-i18n="checking">Pr√ºfe auf Updates...</span>
              <button id="check-update-btn" class="btn-secondary" style="margin-left: 10px;" data-i18n="checkNow">Jetzt
                pr√ºfen</button>
            </div>
            <div id="update-action" style="display: none; margin-top: 15px;">
              <div
                style="background: rgba(0, 255, 255, 0.1); border: 1px solid var(--accent-cyan); padding: 15px; border-radius: 8px;">
                <p style="margin-bottom: 15px;" data-i18n="updateAvailableText">Ein neues Update von GitHub ist
                  verf√ºgbar!</p>
                <button id="execute-update-btn" class="btn-primary" data-i18n="installUpdate">Update jetzt
                  installieren</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Bottom Navigation (Mobile) -->
  <nav class="bottom-nav">
    <button data-tab="modules" class="active">
      <span class="icon">üì¶</span>
      <span data-i18n="modules">Module</span>
    </button>
    <button data-tab="layout">
      <span class="icon">üé®</span>
      <span data-i18n="layout">Layout</span>
    </button>
    <button data-tab="appstore">
      <span class="icon">üè™</span>
      <span data-i18n="appStore">Store</span>
    </button>
    <button data-tab="settings">
      <span class="icon">‚öôÔ∏è</span>
      <span data-i18n="settings">Einstellungen</span>
    </button>
  </nav>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="i18n.js"></script>
  <script src="visual-editor.js"></script>
  <script src="app.js"></script>
</body>

</html>